%!TEX root=report.tex
\subsection{Phase and Amplitude}

The $\hat{\beta}$ parameter in the OLS problem contains the coefficients to the linear combinations of $\cos(\omega_i t)$ and $\sin(\omega_i t)$, there is are used to predict $Y$.
Since there is a cosine and sine for each frequency in the design matrix $X$, one will end up with a linear combination of frequency function pairs. This makes interpretation difficult.
Instead one should convert the $\beta$ parameters for the trigonometric functions into amplitudes and phases corresponding to each pair of periodic functions such that only a cosine  $A_i \cos(\omega_i t - \phi_i)$ is needed.
This is done by using Ptolemy's theorem
\begin{equation}
A_i \cos(\omega_i t - \phi_i) = A_i \cos(\phi_i) \cos(\omega_i t) + A_i \sin(\phi_i) \sin(\omega_i t).
\end{equation}

Comparing with the linear combination from OLS
\begin{align}
\hat{Y} = \cdots + \beta_{c,i} \cos(\omega_i t) + \beta_{s,i} \sin(\omega_i t) + \cdots
\end{align}
It is seen that
\begin{align}
\beta_{c,i} = A_i \cos(\phi_i) && \text{ and } && \beta_{s,i} = A_i \sin(\phi_i).
\end{align}

By dividing these two equations with each other, $\phi_i$ can be calculated as 
\begin{equation}
\frac{A_i \sin(\phi_i)}{A_i \cos(\phi_i)} = \frac{\beta_{s,i}}{\beta_{c,i}} \Rightarrow \phi_i = \arctan\left(\frac{\beta_{s,i}}{\beta_{c,i}}\right).
\end{equation}

To isolate $A_i$, square both equations and add them together
\begin{equation}
A_i^2 \cos(\phi_i)^2 + A_i^2 \sin(\phi_i)^2 = \beta_{c,i}^2 + \beta_{s,i}^2 \Rightarrow A_i = \sqrt{\beta_{c,i}^2 + \beta_{s,i}^2}.
\end{equation}

The result can be plotted with a circular color scale, using $\phi_i$ (the hue) and $A_i$ (the intensity).
